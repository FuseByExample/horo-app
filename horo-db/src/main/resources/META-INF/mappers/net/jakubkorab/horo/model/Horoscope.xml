<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Horoscope">

    <!-- Result maps describe the mapping between the columns returned
   from a query, and the class properties.  A result map isn't
   necessary if the columns (or aliases) match to the properties
   exactly. -->
    <resultMap id="HoroscopeResult" type="Horoscope">
        <result property="id" column="horoscope_id"/>
        <!-- feed_id -->
        <result property="sign" column="sign_name"/>
        <result property="predictsFor" column="predicts_for"/>
        <result property="entry" column="entry"/>
    </resultMap>

    <!-- Select with no parameters using the result map for Account class. -->
    <select id="selectAllHoroscopes" resultMap="HoroscopeResult">
        select h.horoscope_id, s.name, h.predicts_for, h.entry 
            from horoscopes h
            inner join signs s on (h.sign_id = s.sign_id)
    </select>

    <!-- Insert example, using the Account parameter class -->
    <insert id="insertHoroscope" parameterType="Horoscope">
        insert into horoscopes (
            sign_id,
            feed_id,
            predicts_for,
            entry
        )
        select s.sign_id, f.feed_id, #{predictsFor}, #{entry} 
            from signs s, feeds f
            where s.name = #{starSign.name}
                and f.name = #{feed.name}
    </insert>

    <!-- START SNIPPET: insertList -->
    <!-- Batch Insert example, using the Account parameter class -->
    <!--
    <insert id="batchInsertAccount" parameterType="java.util.List">
        insert into ACCOUNT (
        ACC_ID,
        ACC_FIRST_NAME,
        ACC_LAST_NAME,
        ACC_EMAIL
        )
        values (
        <foreach item="Account" collection="list" open="" close="" separator="),(">
            #{Account.id}, #{Account.firstName}, #{Account.lastName}, #{Account.emailAddress}
        </foreach>
        )
    </insert>
    -->
    <!-- END SNIPPET: insertList -->


    <!-- Delete example, using an integer as the parameter class -->
    <!--
    <delete id="deleteAccountById" parameterType="int">
        delete from ACCOUNT where ACC_ID = #{id}
    </delete>
-->

    <!--
    <select id="count" resultType="int">
        select count(*) from ACCOUNT
    </select>
    -->
</mapper>
